OASISFormat: 0.4
Name:        httpaf
Version:     dev
Authors:     Spiridon Eliopoulos <spiros@inhabitedtype.com>
Maintainers: Spiridon Eliopoulos <spiros@inhabitedtype.com>
License:     BSD-3-clause
Plugins:     META (0.4), DevFiles (0.4)
BuildTools:  ocamlbuild
Synopsis:    A high-performance, memory-efficient, and scalable web server for OCaml.


Flag async
  Description: build the Async libraries
  Default: false

Library httpaf
    Path:           lib
    Pack:           true
    Findlibname:    httpaf
    BuildDepends:   angstrom, faraday, result
    NativeOpt:      -S -g
    Modules:
        Body,
        Connection,
        Headers,
        IOVec,
        Method,
        Request,
        Response,
        Status,
        Version
    InternalModules:
        Bigstring,
        Message,
        Parse,
        Serialize

Library httpaf_async
  Path:           async
  Findlibname:    async
  Findlibparent:  httpaf
  Build$:         flag(async)
  Install$:       flag(async)
  BuildDepends:   httpaf, faraday.async, core, async, threads
  NativeOpt:      -g
  Modules:
    Httpaf_async

Library httpaf_effects
  Path:           effects
  Findlibname:    effects
  Findlibparent:  httpaf
  BuildDepends:   httpaf, faraday, core, aeio
  NativeOpt:      -g
  Modules:
    Httpaf_effects

Executable wrk_async_benchmark
  Path:             benchmarks
  MainIs:           wrk_async_benchmark.ml
  Build$:           flag(async)
  NativeOpt:        -g
  CompiledObject:   best
  Install:          false
  BuildDepends:     httpaf.async, async, threads

Executable wrk_effects_benchmark
  Path:             benchmarks
  MainIs:           wrk_effects_benchmark.ml
  NativeOpt:        -g
  CompiledObject:   best
  Install:          false
  BuildDepends:     httpaf.effects, aeio


Executable test_angstrom
  Path:             lib_test
  MainIs:           test_httpaf.ml
  Build$:           flag(tests)
  CompiledObject:   best
  Install:          false
  BuildDepends:     httpaf
